diff --git a/src/crypto/tls/common.go b/src/crypto/tls/common.go
index d6942d2ef1..b9167f1cf4 100644
--- a/src/crypto/tls/common.go
+++ b/src/crypto/tls/common.go
@@ -26,7 +26,7 @@ import (
 	"strings"
 	"sync"
 	"time"
-	_ "unsafe" // for linkname
+	"unsafe" // for linkname and ClientHelloHook
 )
 
 const (
@@ -541,6 +541,10 @@ const (
 // modified. A Config may be reused; the tls package will also not
 // modify it.
 type Config struct {
+	// ClientHelloHook allows direct modification of the internal ClientHello.
+	// The argument is the raw internal struct pointer.
+	ClientHelloHook func(unsafe.Pointer)
+
 	// Rand provides the source of entropy for nonces and RSA blinding.
 	// If Rand is nil, TLS uses the cryptographic random reader in package
 	// crypto/rand.
@@ -927,6 +931,7 @@ func (c *Config) Clone() *Config {
 	c.mutex.RLock()
 	defer c.mutex.RUnlock()
 	return &Config{
+		ClientHelloHook:                     c.ClientHelloHook,
 		Rand:                                c.Rand,
 		Time:                                c.Time,
 		Certificates:                        c.Certificates,
diff --git a/src/crypto/tls/handshake_client.go b/src/crypto/tls/handshake_client.go
index 38bd417a0d..e3a83c67d5 100644
--- a/src/crypto/tls/handshake_client.go
+++ b/src/crypto/tls/handshake_client.go
@@ -28,6 +28,7 @@ import (
 	"strconv"
 	"strings"
 	"time"
+	"unsafe"
 )
 
 type clientHandshakeState struct {
@@ -248,6 +249,11 @@ func (c *Conn) makeClientHello() (*clientHelloMsg, *keySharePrivateKeys, *echCli
 		}
 	}
 
+	fn := c.config.ClientHelloHook
+	if fn != nil {
+		fn(unsafe.Pointer(hello))
+	}
+
 	return hello, keyShareKeys, ech, nil
 }
 
